<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>conda_vsc</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><p><strong>Python + Visual Studio Code</strong></p>
<p>2018-11-23<br>
Jun Sok Huhh | 🏠<a href="http://lostineconomics.com">lostineconomics.com</a></p>
<h1 id="들어가며">들어가며</h1>
<p>아마 각자 알아서 잘 쓰는 Python 설정이 있을 것이다. 그대로 잘 쓰면 되겠다. 하지만 막 Python으로 코딩을 시작하려는 사람이 있다면 이런 글도 조금은 도움이 되지 않을까 한다. 이 가이드의 목표는 다음과 같다.</p>
<ol start="0">
<li>되도록 꼬이지 않게 Python 쓰기 (사실 쓰다보면 종종 꼬인다)</li>
<li>되도록 편리하게 쓰기</li>
<li>OS를 가리지 않고 쓰기</li>
</ol>
<p>Python이 무척 훌륭한 언어지만 사실 가이드가 아주 친절하지는 않다. 입문서들을 봐도 혹은 웹서핑을 해봐도 그렇다. 아울러 같은 오픈소스 언어라도 RStudio 같은 편리한 개발툴까지 손에 쥐어주는 R에 비해서 어딘가 불편하고 부족하다는 느낌도 받을 수 있다. Python을 쓰면서 불편하다고 느껴본 적 없다, 라는 분들은 여기서 이 글을 안 읽어도 좋겠다.</p>
<p>이 가이드는 거의 R + RStudio에 근접한 수준으로 Python을 쓰게 하는 데 필요한 작업을 담고 있다. 부디 이 글을 보는 분들에게 시간 단축의 축복 있으라! 가이드는 다음과 같은 세가지 영역을 다룬다.</p>
<ol>
<li>어떤 Python 배포판을 쓸까?</li>
<li>어떻게 쓸까?</li>
<li>무엇과 함께 쓸까?</li>
</ol>
<h1 id="어떤-python-배포판을-쓸까">어떤 Python 배포판을 쓸까?</h1>
<p>나는 하드코어하게 그냥 바닐라 Python을 쓰겠어, 라고 결심해도 좋겠다. 하지만 곧 여러가지 장애물을 만나게 될 것이다. 특히 윈도를 쓰는 이용자라면 더욱 그렇다. CLI를 맥OS나 리눅스 만큼 자유롭게 쓸 수 없기에 답답할 때가 많다. 게다가 PATH 걸기 등에서 문제가 생기면 참 난감하다. 또한 각종 패키지 또한 누가 한번 더 걸러서 잘 관리를 해주고 그 녀석들을 끌어다 쓰면 조금 더 편리하게 쓸 수 있지 않을까 싶다. 이러한 목적에 딱 맞는 것이 아나콘다(Anaconda) 사에서 배포하는 아나콘다 배포판이다. 아마도 Python을 쓰는 사람이라면 아나콘다를 한번쯤은 깔아보았을 터다. 우리도 아나콘다를 쓸 것이다. 아나콘다 배포판이 좋은 이유는 두 가지 정도다.</p>
<ol>
<li>아나콘다에서 패키지 관리를 성실하게 해준다.
<ul>
<li>때로는 바닐라 버전보다 아나콘다 버전이 성능상 유리한 경우도 있다.</li>
</ul>
</li>
<li>아나콘다에서 제공하는 가상 환경이 편리하고 훌륭하다.
<ul>
<li>virtualenv 패키지를 써도 좋겠지만 패키지 관리까지 한방에 해결할 수 있는 아나콘다 가상환경이 조금 더 편리하다.</li>
</ul>
</li>
</ol>
<p>1이야 그렇다고 치고 2는 정말 중요하다. Python과 그 구성요소들은 대체로 가볍다. 여느 소프트웨어처럼 "Python + 필요 패키지"를 구축한 후 이 환경 내에서만 쓰면 여러가지 이점이 있다. 하지만 이렇게 여러 패키지를 깔면 깔수록 무거워지고 문제가 발생할 소지가 높다. 만일 작업 환경을 따로따로 관리한다면, 문제가 생겼을 때 이 환경만 날려버리면 된다. 패키지 하나 잘못 깔았다고 낙담할 필요가 없다. 아울러 필요한 구성만 갖추기 때문에 실행 속도 등에서도 약간의 이익을 볼 수 있다.</p>
<p>이제 아나콘다를 쓰기로 했다고 치자. 아나콘다도 두 가지로 배포판이 제공한다. 종합 배포판인 아나콘다 대신 핵심 만을 발라낸 <a href="https://conda.io/miniconda.html">Miniconda</a>가 좋다. 미니콘다가 왜 좋을까? 보통 아나콘다를 풀 버전을 깔면 (내 기준으로는) 쓸 데 없는 것들이 같이 깔린다. 일종의 합집합 개념의 여러 패키지를 제공하는데, 이 방식이 길이 들면 이후에 곤란한 경우에 처할 수도 있다. 하드 디스크의 용량이 부족한 시대는 아니지만, 잘 쓰지 않는 것을 갖고 있을 필요도 없지 않을까.</p>
<h1 id="어떻게-쓸까">어떻게 쓸까?</h1>
<p>일단 미니콘다를  Python 3.X 버전으로 (전부 "NEXT"를 눌러) 깔았다고 가정하자. 대신 미니콘다를 쓰려면 약간의 CLI를 활용할 줄 알아야 한다. 맥OS나 리눅스에서는 그냥 터미널을 열고 쓰면 되니, 윈도 기준으로 설명하겠다.</p>
<p><img src="https://github.com/anarinsk/public_writing/blob/master/conda_vsc/imgs/conda_prompt.png?raw=true" alt="" width="300" height="500"></p>
<p>일단, 탐색창에서 anaconda prompt를 검색하면 다음과 같이 뜬다. 윈도우에서 발생할 수 있는 각종 문제를 해결한 아나콘다 전용창이라고 생각하면 되겠다. 윈도우10이면 그면 command 창을 띄워서 쓰면 될 것이다. 다만 7버전 이라면 앞으로 아나콘다 관련 명령어들은 이 녀석을 띄우고 실행시키면 좋다.</p>
<p>아나콘다의 각종 명령어에 대한 자세한 해설은 링크와 같다. 하지만 엑기스만 뽑아서 간단히 설명하도록 하자. 창을 실행하면 "(base)"라는 문구가 보일 것이다. 이는 현재 아나콘다가 실행되고 있는 환경을 뜻한다. 이미 Python 가상환경이 들어와 있다! Miniconda의 클라이언트와 함께 Python 3.X 버전이 깔려 있다는 뜻한다.</p>
<ul>
<li>conda의 활용법을 자세히 알고 싶다면 <a href="https://conda.io/docs/user-guide/getting-started.html">LINK</a>를 참고하라.</li>
<li>가상 환경에 관한 자세한 내용은 <a href="https://conda.io/docs/user-guide/tasks/manage-environments.html">LINK</a>를 참고하라.</li>
</ul>
<h2 id="update-conda">Update Conda</h2>
<pre class=" language-cmd"><code class="prism  language-cmd">conda update conda
</code></pre>
<ul>
<li>항상 콘다를 실행하고 나면 먼저 실행해야 할 명령이다.</li>
<li>아나콘다 배포판을 관리하는 메타툴이 conda이고 이 녀석을 업데이트하라는 뜻이다. 제 머리 깎는 중인 셈이다.</li>
</ul>
<h2 id="create">Create</h2>
<pre class=" language-cmd"><code class="prism  language-cmd">conda create -n 환경이름 python=3.6
</code></pre>
<ul>
<li>앞으로 사용자가 각자 지정해주는 부분은 한글로 표기하도록 한다.</li>
<li><code>create</code> 명령어에 여러가지 옵션이 있지만 여기서는 Python 버전만 지정하도록 하겠다.</li>
<li>이렇게 설치된 아나콘다의 환경은 윈도우 기준으로  <code>appdata\miniconda\envs</code> 에 설치되어 있다. appdata 폴더를 보려면 탐색기 옵션을 고쳐야 한다. <a href="https://support.microsoft.com/ko-kr/help/14201/windows-show-hidden-files">LINK1</a>, <a href="https://support.microsoft.com/ko-kr/help/4028316/windows-view-hidden-files-and-folders-in-windows-10">LINK2</a>를 참고 하라.</li>
</ul>
<h2 id="activate-env-and...">Activate env, and…</h2>
<p>다음으로 환경으로 진입해야 한다.</p>
<pre class=" language-cmd"><code class="prism  language-cmd">conda activate 환경이름
</code></pre>
<p>위의 명령어는 윈도우 기준이다. 맥OS나 리눅스는 <code>source activate 환경이름</code>을 쓰면 된다. 이제 원하는 패키지를 깔면 된다.</p>
<pre class=" language-cmd"><code class="prism  language-cmd">conda install -c conda-forge numpy
</code></pre>
<p>사례로 numpy 패키지를 깔아 보았다. 위 명령어는 conda 명령어로 anaconda-forge 채널을 통해 numpy를 설치한 것이다. 통상적으로 pip 명령어를 써서 패키지를 인스톨해도 된다.</p>
<h2 id="view-env">View env</h2>
<pre class=" language-cmd"><code class="prism  language-cmd">conda info --envs 
</code></pre>
<ul>
<li>현재 콘다 내에서 사용할 수 있는 환경을 보여준다.</li>
</ul>
<h2 id="remove-env">Remove env</h2>
<p>환경에 문제가 생겼을 경우 이렇게 지우면 된다.</p>
<pre class=" language-cmd"><code class="prism  language-cmd">conda env remove -n 환경이름
</code></pre>
<ul>
<li>아니면 앞서 봤던 폴더에 가서 파일을 지워버려도 된다.</li>
<li>env의 이름을 바꾸고 싶으면 해당 폴더의 이름을 바꿔주면 된다.</li>
</ul>
<h2 id="copy-env">Copy env</h2>
<p>이미 설치된 환경(클론되는환경)을 다른 이름(클론될환경)으로 카피하고 싶으면 아래의 명령어를 활용하자.</p>
<pre class=" language-cmd"><code class="prism  language-cmd">conda create -n 클론될환경 -c 클론되는환경
</code></pre>
<ul>
<li>환경을 복제하고 싶으면 그냥 해당 폴더를 복사에 붙인 후 다른 이름을 붙여주면 된다.</li>
</ul>
<h2 id="enter-your-env">Enter your env</h2>
<p>이제 필요한 패키지들을 깔아서 쓰면 된다. 그전에 잠깐! 필요한 패키지들은 해당 환경 안에 깔아줘야 의도한 대로 쓸 수 있다! 환경에 진입하도록 하자.</p>
<pre class=" language-cmd"><code class="prism  language-cmd">conda activate 환경이름
</code></pre>
<p>환경에서 나가기 위해서는</p>
<pre class=" language-cmd"><code class="prism  language-cmd">conda deactivate 환경이름
</code></pre>
<ul>
<li>윈도에서는 이렇게 하면 된다. 맥OS나 Linux라면 <code>conda</code>  대신 <code>source</code>를 치면 된다.</li>
</ul>
<h2 id="install-packages">Install packages</h2>
<pre class=" language-cmd"><code class="prism  language-cmd">conda install -c conda 패키지이름
</code></pre>
<ul>
<li>기본적으로 사용하는 <code>pip</code>를 써도 된다.</li>
</ul>
<h1 id="무엇과-함께-쓸까">무엇과 함께 쓸까?</h1>
<p>이제 conda와 잘 어울리는 짝으로는 MS에서 무료로 배포하는 Visual Studio Code(VCS)를 권한다. 개인적으로 마소에서 낸 제품 중 최고의 걸작이 아닐까 싶다. VCS에 대한 자세한 설명은 생략하자.</p>
<p>Python을 VCS와 함께 쓸 때의 장점은 다음과 같다.</p>
<ul>
<li>여느 에디터의 장점들(예상 명령어 등등)
<ul>
<li>다양한 테마</li>
<li>단축키</li>
<li>탭으로 명령어 채우기</li>
<li>내부에서 터미널(cmd)를 실행 가능</li>
</ul>
</li>
<li>Git이 통합되어 있어서 git 관리가 편리</li>
<li>conda 환경을 지정해 실행 가능</li>
<li>Jupyter의 환경을 그대로 가져와서 실행 결과 바로바로 보여주기</li>
</ul>
<p>이런 것들을 구현해주기 위해서 작업 환경에 두가지 패키지를 깔면 된다.</p>
<ul>
<li>Jupyter or Jupyerlab</li>
<li>pylint</li>
</ul>
<p>pylint의 경우 해당 conda 환경에 안 깔려 있으면 VSC에서 깔지 않겠느냐고 물어보고, conda로 깔지 pip로 깔지까지 물어본다. 혹시 생략했다면 VSC안에서 처리가 가능하다.</p>
<p>이렇게 깔아 놓고 <code>*.py</code>을 불러오자. 에디터 창에서 매직코멘트로 <code>#%%</code>을 쓴다. 매직 코멘트는 pylint 패키지가 해당 명령어를 Jupyter로 넘길 수 있도록 지정한다. VSC에서 pylint가 제대로 작동한다면 다음과 같은 화면일 볼 수 있을 것이다.</p>
<p><img src="https://github.com/anarinsk/public_writing/blob/master/conda_vsc/imgs/pylint.png?raw=true" alt="" width="600" height="400"></p>
<p>빨간색 박스에너 "Run Call"은 해당 매직코멘트 블록을 실행하라는 의미다. Jupyter 내에서 한 블록으로 이해하면 된다. pylint의 작동원리는 해당 코멘트를 Jupyter로 넘겨 실행한 후 이를 받아서 다시 VSC 내에 뿌려준다. 결과는 아래와 같이 번듯하다!</p>
<p><img src="https://github.com/anarinsk/public_writing/blob/master/conda_vsc/imgs/vsc_1.png?raw=true" alt="" width="700" height="370"></p>
<p>앞서 conda를 통해서 다양한 가상 환경을 설치했다면 이 환경을 선택해 VSC에서 실행할 수 있어야 할 것이다. 위의 창에서 맨 보라색 맨 아래줄의 하단을 보자.</p>
<p><img src="https://github.com/anarinsk/public_writing/blob/master/conda_vsc/imgs/vsc_2.png?raw=true" alt="" width="450" height="160"></p>
<p>저 위치를 클릭하면 에디터 위쪽으로 아래 같은 화면이 뜬다. 화면에서 해당 환경을 선택하면 된다.</p>
<p><img src="https://github.com/anarinsk/public_writing/blob/master/conda_vsc/imgs/vsc_3.png?raw=true" alt="" width="600" height="380"></p>
<h2 id="주의-사항">주의 사항</h2>
<p>가끔 환경을 세팅한 후 해당 환경이 VSC에서 안뜨는 상황을 맞이할 수 있다. 그럴 때에는 해당 환경에 pylint가 설치되어 있는지 확인한 후 설치되어 있다면 환경 선택 부분에 리로드 아이콘을 눌러주자. 그냥 에디터를 다시 실행해도 된다. 그러면 해당 환경을 확인할 수 있을 것이다.</p>
<h1 id="a-nice-practice">A nice practice</h1>
<p>이렇게 쓰면 좋다,라는 모델 케이스를 정리해보자. 물론 "이게 최선"은 아니겠지만, 그래도 꽤 삽질을 거친 결과니 참고하면 좋을 듯 하다. 가장 번거롭고 난이도가 높은 윈도 기준이다.</p>
<ol>
<li>miniconda 설치</li>
<li>VSC 설치</li>
<li>miniconda에 Python 작업 환경 설치 및 환경별 패키지 설치</li>
<li>VSC 실행</li>
<li>필요한 <code>*.py</code> 생성 혹은 로딩</li>
<li>VSC를 통해 작업</li>
</ol>
<h2 id="one-more-tip">One more tip</h2>
<p>매번 이렇게 환경을 설치해서 쓰기 귀찮을 수 있다. 그렇다면 많이 쓰는 공통 세팅을 하나 만들어 두고 이 녀석을 복사해서 쓰면 되겠다. 앞서 보았듯이 <code>conda create</code>… 명령으로 환경을 복사해서 쓰거나 아니면 그냥 폴더/디렉토리로 들어가서 내용을 복사한 뒤 이름을 바꾸면 된다. 실은 나도 그렇게 쓰고 있다.</p>
<p>아울러 코드를 배포할 일이 있을 때 실행 환경을 담보해야 할 것이다. 이럴 때는 yml을 쓰면 좋다.</p>
<h3 id="yml-사용하기">yml 사용하기</h3>
<p>yml 파일을 생성해서 한방에 패키지들을 설치하는 방법은 다음과 같다.</p>
<pre class=" language-cmd"><code class="prism  language-cmd">conda env export &gt; 환경이름.yml
</code></pre>
<p>현재 환경을 yml 파일로 저장한다. 해당 yml을 다시 환경으로 풀려면</p>
<pre class=" language-cmd"><code class="prism  language-cmd">conda env create -f 환경이름.yml
</code></pre>
<p>해당 yml 파일에서 환경을 복원한다. 작업한 환경을 yml로 포팅해 두면 패키지의 버전까지 기억했다가 그대로 복원한다.<br>
🐾<br>
🐾<br>
🐾<br>
🐾<br>
🐾Jun Sok Huhh | 🏠<a href="http://lostineconomics.com">lostineonomics.com</a></p>
</div>
</body>

</html>
